//
// Created by Иван on 4/29/2024.
//

#include "MHDProblem.h"

MHDProblem::MHDProblem(double gam_hcr_init, double x0_init, double L_init, double t0_init, double T_init, double h_init, double tau_init, bool what_is_L_init) {
    gam_hcr = gam_hcr_init;
    x0 = x0_init;
    if(what_is_L_init){
        L = L_init;
        X = x0 + L;
    }
    else {
        X = L_init;
        L = X-x0;
    }
    t0 = t0_init;
    T = T_init;
    h = h_init;
    tau = tau_init;

    //TODO: исправить вычисление
    gam_courant = fabs( tau / h);
    if(gam_courant > 1)
        std::cout << "LOG[WARNING]: Courant number is greater than 1!!!" << std::endl;

    num_time_steps = static_cast<int>((T-t0) / tau);
    num_space_steps = static_cast<int>((X - x0)/h);
}


//std::cout<<"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡀⠀⠀⠀⠀⢀⣠⣴⠖⠚⠉⠉⠉⠉⠀⠀⠀⠀⠈⠉⠉⠉⠉⠉⠉⠓⠲⠶⣤⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⣷⡄⣠⡴⠛⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠓⢤⣄⠀⢠⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⣿⡉⠀⠀⠀⠀⣀⣀⣠⠤⠴⠶⠒⠒⠒⠒⠒⠒⠲⠶⠦⠤⣀⣀⣀⠀⠀⠀⠀⠀⠀⠀⠉⣳⣾⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡴⣿⠛⣿⣿⣤⡤⠖⠛⠉⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠉⠛⠲⢤⣀⠀⠀⢀⣼⣿⣿⡟⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡾⠋⠀⢻⣤⣿⡿⠃⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣀⣀⣀⣀⣀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢳⣯⣾⣿⣿⠃⠈⠻⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⠀⠀⠀⢀⡴⠋⠀⠀⠀⣰⣿⡿⠁⠀⠀⣀⣠⠤⠶⠒⠊⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠙⠒⠶⠤⣄⣀⡀⠀⠀⠀⠀⢻⣿⠁⡾⠀⠀⠀⠘⢦⠀⠀⠀⠀⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⠀⠀⣠⠟⠀⠀⠀⢠⣾⡟⠛⠁⢀⡴⠛⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠳⣤⡀⠀⢸⣿⡾⣧⡀⠀⠀⠀⠈⢷⡀⠀⠀⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⠀⣴⠏⠀⠀⠀⡴⠋⠛⣠⡄⢠⡞⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠻⡆⠀⢻⠇⣿⢳⡀⠀⠀⠀⠈⢷⡀⠀⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⣼⠃⠀⠀⠀⡾⢁⡴⠋⠁⢷⠏⠀⠀⠀⢀⠀⠀⠀⠀⠀⣸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⣆⠀⣴⡉⠀⢳⡄⠀⠀⠀⠈⢳⠀⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⣼⠇⡀⠀⢀⣾⠟⠋⠀⠀⠀⡀⠀⠀⠰⠀⡾⠀⠀⠀⠀⠀⡏⢠⠄⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⠀⠀⠀⠀⠀⠀⠀⠸⣶⠇⠙⢧⡈⢷⡀⠀⠀⡀⠘⡇⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⢰⠏⢰⡇⠀⠈⠉⠀⠀⠀⠀⢀⠃⠀⠀⡆⠀⠇⠀⠀⠀⠀⢠⠃⡏⢠⡇⠀⠀⠀⠀⠀⡆⢠⠀⠀⣴⠀⠀⠀⠀⠀⠀⠀⠀⢹⠀⠀⠀⠹⣞⡧⠀⠀⡇⠀⢻⠀⠀⠀⠀⠀\n"
//"⠀⠀⠀⡿⠀⡾⠁⠀⠀⠀⣸⠁⠀⠀⡿⠀⠀⢸⠃⢸⠀⠀⠀⠀⠀⣼⢠⠃⢸⡇⠀⠀⠀⠀⢠⡇⡆⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⢸⡆⠀⠀⠀⢨⡿⠀⠀⣿⠀⢸⡄⠀⠀⠀⠀\n"
//"⠀⠀⢸⠁⢸⡇⠀⠀⠀⢀⡇⠀⠀⣸⠁⠀⠀⡼⠀⣾⠀⠀⠀⠀⢀⡿⣼⠀⢸⠀⠀⠀⠀⠀⢸⢃⡇⠀⢠⢹⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇⠀⠀⠀⢸⠃⠀⠀⣿⠀⠈⠇⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⣼⠀⠀⠀⠀⣼⠀⠀⢠⡏⠀⠀⣰⡇⠀⡏⠀⠀⠀⠀⢸⡇⡿⠀⣿⠀⠀⠀⠀⠀⣸⢺⠃⠀⣸⢸⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇⠀⠀⠀⢸⠀⠀⠀⢻⡄⠀⡃⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠁⠀⣼⠀⠀⢠⣿⡇⢸⡇⠀⠀⠀⠀⢸⢳⡇⢰⣿⠀⠀⠀⠀⠀⡇⡼⠀⠀⣿⢸⠀⠀⠀⠀⠀⠀⣾⠀⠈⡇⠀⠀⠀⡇⠀⠀⠀⢸⡇⠀⡇⠀⠀⠀⠀\n"
//"⠀⢰⠀⠀⠀⠀⠀⠀⢠⡏⠀⢰⡇⠀⠀⣿⣿⠃⢸⡃⠀⠀⠀⢰⣾⣿⡇⣾⣿⠀⠀⠀⠀⢰⣧⡇⠀⢠⣿⢸⡇⠀⠀⠀⢸⢀⣿⠀⢀⡇⠀⠀⢀⡇⠀⠀⠀⢸⡇⠀⡇⠀⠀⠀⠀\n"
//"⠀⡎⠀⠀⠀⠀⠀⠀⣸⠁⢠⣿⡇⠀⢰⢻⣿⠓⢺⠗⠒⠒⠲⢶⣿⡟⡇⡿⢸⡆⠀⠀⠀⣼⣿⣇⣀⣾⣼⣼⣧⣀⡀⠀⢸⣸⣷⠀⢸⣷⠘⡀⢸⠇⠀⠀⠀⢸⡇⠀⣯⠀⠀⠀⠀\n"
//"⠀⠇⠀⠀⠀⠀⠀⠀⣿⠀⡟⢸⠀⠀⣿⣿⢸⠀⢸⠀⠀⠀⠀⢠⣿⡇⣧⠃⢸⡇⠀⠀⠀⣿⡼⠀⢰⡟⢸⣽⠃⠀⠈⠙⣿⣿⢼⡀⢸⣿⠀⡇⣼⠀⠀⠀⠀⢸⡇⠀⣿⠀⠀⠀⠀\n"
//"⠀⠀⠀⠀⠀⠀⠀⠀⣿⣼⠁⡏⠀⢀⡏⡏⢸⠀⢸⠀⠀⣀⠀⢸⣿⢺⢸⠀⢸⡇⠀⠀⢀⣧⡇⠀⣸⠁⢸⣿⠀⠀⠀⠀⡏⣿⠸⠀⢹⣿⣰⣿⡇⠀⠀⠀⠀⣸⠀⠀⣿⠀⠀⠀⠀\n"
//"⢰⠀⠀⠀⠀⠀⠀⠀⣟⡟⢰⡇⠀⣼⢡⠃⢸⡄⢸⠀⠀⠉⠃⢸⣿⢸⣾⠀⢸⡇⠀⠀⣸⣾⠃⢰⡇⠀⣼⣿⠀⠀⠀⢰⣿⡿⡆⠀⢸⡿⡏⣿⡇⠀⠀⠀⠀⣿⠀⠀⢹⠀⠀⠀⠀\n"
//"⢸⠀⠀⠀⠀⠀⠀⠠⣿⠀⢸⡇⢰⡏⢸⠀⠸⡇⢸⡇⠀⢀⠀⢸⡿⢸⡏⠀⠸⡇⠀⠀⢿⡇⠀⣼⣀⣀⣻⣧⠀⠀⠀⣾⡿⡇⡇⠀⣸⠀⣧⣿⠁⠀⠀⠀⠀⡿⠀⠀⢸⡄⠀⠀⠀\n"
//"⢸⠀⠀⠀⠀⠀⠀⠀⣿⠀⢸⣇⣼⣷⣬⣀⣀⣛⣈⣭⣽⣿⣿⠎⠁⠘⠁⠀⠀⠀⠀⠀⠘⠁⠘⠻⠷⣿⣭⣉⣉⠀⢸⣿⣣⣇⣇⣠⡟⠀⢿⣯⠀⠀⠀⠀⠀⣇⠀⠀⠈⣇⠀⠀⠀\n"
//"⢸⡄⠀⢰⠀⠀⠀⠀⣿⠀⠘⠃⠉⠙⠛⠛⠛⠛⠛⠛⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠛⠿⠿⠿⣿⠿⢿⡟⡿⠃⠀⢘⡇⠀⠀⠀⠀⢸⡷⠀⠀⠀⢻⠀⠀⠀\n"
//"⢸⡇⠀⢸⠀⠀⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⡀⠀⠀⣸⠁⠀⠀⠀⠀⣾⣇⠀⠀⠀⠘⣆⠀⠀\n"
//"⠸⡇⠀⠘⡀⠀⠀⠀⣿⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠛⠉⠁⠀⣿⠀⠀⠀⠀⠀⡟⣿⢠⠀⠀⠀⢻⡀⠀\n"
//"⠀⣿⠀⠀⡇⠀⠀⠀⢻⣇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⠇⠀⠀⠀⠀⣸⢣⠇⢸⡇⠀⠀⠀⣷⡀\n"
//"⠀⣿⠀⠀⣿⠀⠀⠀⢸⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⢀⠀⠀⣿⡿⠀⢘⡇⠀⢷⠀⠘⣇\n"
//"⠀⢻⠀⠀⢿⡄⠀⠀⠈⣟⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡏⠀⢀⡞⠀⢀⡟⡇⠀⢸⢇⠀⠀⣧⠀⠘\n"
//"⠀⢸⠀⠀⢸⡇⠀⠀⠀⢻⣿⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣶⡿⠿⠟⠛⠛⠛⠛⠛⠻⠶⣤⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣼⠀⠀⡾⠁⠀⣾⠇⡇⠀⢸⣿⠀⠀⢸⡳⡄\n"
//"⠀⢸⠀⠀⠀⣇⠀⠀⠀⠘⣏⢧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⡏⠀⣰⠃⠀⢸⡇⠀⡇⠀⠀⡿⡇⠀⠀⣧⠈\n"
//"⠀⠀⡀⠀⠀⢸⡄⠀⠀⠀⣿⡘⢷⡀⠀⠀⠀⠀⠀⠀⠀⠀⠸⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣼⡟⠀⢠⠏⠀⢠⡞⠀⠀⣿⠀⠀⢱⢿⠀⠀⢻⡄\n"
//"⠀⠀⠀⠀⠀⠸⡇⠀⠀⠀⢻⡇⢸⣿⣦⣀⠀⠀⠀⠀⠀⠀⠀⠙⢦⡀⠀⠀⠀⠀⠀⠀⢀⡴⠋⠀⠀⠀⠀⠀⠀⠀⠀⢀⣤⣾⣿⡇⢀⡞⠀⢀⡞⣷⡀⠀⠻⠀⠀⠘⣿⡆⠀⠈⣇\n"
//"⠀⠀⠀⠀⠀⠀⣷⠀⠀⠀⠸⡇⠈⣿⡇⣿⣷⣄⡀⠀⠀⠀⠀⠀⠀⠉⠀⠀⠀⢀⣤⠶⠋⠀⠀⠀⠀⠀⠀⠀⠀⣠⣶⡏⠀⣿⡞⠀⡼⠀⠀⣾⠁⢹⣧⠀⠀⠀⠀⠀⢹⣷⠀⠀⢸\n"
//"⠀⠀⡇⠀⠀⠀⢸⣆⠀⠀⠀⢹⡀⢻⣇⢸⡇⠈⢻⣦⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⠔⢿⣿⢿⠀⠀⣿⠁⡼⠁⠀⣰⠃⠀⢸⡾⡄⠀⠀⠀⠀⠈⣿⡄⠀⠀\n"
//"⠀⠀⡇⠀⠀⠀⢸⣿⠀⠀⠀⠸⡇⠘⣿⢸⡇⠀⠈⣿⢹⣷⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣠⠖⠋⠁⠀⣼⣿⣿⠀⢠⠃⣰⠃⠀⢠⣿⡀⠀⠀⢿⢹⡀⠀⠀⠀⠀⢹⣷⠀⠀\n"
//"⠀⠀⣿⠀⠀⠀⢸⡟⣇⠀⠀⠀⢧⠀⣿⠈⡇⠀⠀⠸⣆⣿⣿⣿⣷⣦⣤⠀⠀⠀⠀⣠⡤⠞⠉⠀⠀⠀⣠⠴⠛⠹⣿⠀⡿⣴⠃⠀⢀⡿⢻⡆⠀⠀⠘⣧⢻⡄⠀⠀⠀⠀⣿⠀⠀\n"
//"⠀⠀⡟⠀⠀⠀⣼⠀⢻⠀⠀⠀⠸⣇⣿⠀⣷⠀⠀⠸⣿⣿⣿⣿⣿⣿⣿⣿⠛⠛⠟⠁⣀⣀⣠⡴⠞⡋⠁⠀⠀⠈⣻⡿⣱⠃⠀⢀⣾⠁⠀⣿⡄⠀⠀⠸⣄⠹⣦⣀⣠⠤⢌⠦⢴";